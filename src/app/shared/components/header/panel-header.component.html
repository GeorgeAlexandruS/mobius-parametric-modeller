<div class='container__header'>

    <!-- hidden components (new file, save file, loaf file) for the dropdown menu-->
    <div style="display: none;">
        <file-new></file-new>
        <file-save></file-save>
        <file-load></file-load>
    </div>

    <!-- buttons -->
    <div class='header-btn-group'>

        <!-- top left dropdown menu -->
        <!-- <div class="dropmenu"> -->
            <!-- dropdown menu for new file, save file, loaf file-->
            <!-- <div> -->
                <!--
                <button id='dropdownButton' class='btn' mat-icon-button (click)='openDropdownMenu($event)'>
                    <mat-icon svgIcon="cMenu" id='dropdownIcon'></mat-icon>
                </button>
                -->
            <!-- </div>
        </div> -->
                        

        <!-- buttons to navigate to the 4 pages -->
        <button class='btn' [class.active]='getUrl()=="/about"' [routerLink]="'/about'" title='About'>
            <mat-icon svgIcon="cGallery"></mat-icon>
        </button>
        <button class='btn' [class.active]='getUrl()=="/gallery"' [routerLink]="'/gallery'" title='Gallery'>
            <mat-icon>view_comfy</mat-icon>
        </button>
        <button class='btn' [class.active]='getUrl()=="/dashboard"' [routerLink]="'/dashboard'" title='Dashboard'>
            <mat-icon svgIcon="cDashboard"></mat-icon>
        </button>
        <button class='btn' [class.active]='getUrl()=="/flowchart"' [routerLink]="'/flowchart'" title='Flowchart'>
            <mat-icon svgIcon="cFlowchart"></mat-icon>
        </button>
        <button class='btn' [class.active]='getUrl()=="/editor"' [routerLink]="'/editor'" title='Procedure'>
            <mat-icon svgIcon="cEditor"></mat-icon>
        </button>
                
        <!-- execute button -->
        <div class='executeCls' [class.disabled]='!executeCheck'>
            <execute ></execute>
        </div>
    </div>

    <div class='nodename-container' *ngIf='executeCheck'>
        <div id = 'node-name' (click)='openNodeMenu($event)'><span id='node--name' title='{{getNode().name}}'>{{flowchart.meta.selected_nodes[0]}}. {{getNode().name}}</span><span id='node--arr'>▾</span></div>
        <div id="nodeMenu">
            <div *ngFor='let nd of flowchart.nodes; let i = index;'>
                <li (click)="changeNode(i)"> 
                    {{i}}. {{nd.name}}
                </li>
            </div>
        </div>
    </div>

    <div class='filename-container' *ngIf='executeCheck'>
        <!-- <div class = "divider"></div> -->

        <!-- <div id='filename' (click)='openDropdownMenu($event)'>{{getTitle()}}</div> -->
        <button id='dropdownMenuButton' class='menu-btn' (click)='openDropdownMenu($event)' title='Procedure'>
            <mat-icon>menu</mat-icon>
        </button>
        <div class='dropdownContainer'>
            <div id="dropdownMenu">
                <button onclick="document.getElementById('newfile').click();"
                title="Create New Flowchart"> 
                    <mat-icon>rotate_left</mat-icon> 
                    New File
                </button>
                <br>
                <button onclick="document.getElementById('savefile').click();"
                title="Save Flowchart File to Computer">
                    <mat-icon>save_alt</mat-icon>
                    Save File
                </button>
                <br>
                <button (click)="loadFile()"
                title="Load Flowchart File from Computer">
                    <mat-icon>launch</mat-icon>
                    Load File 
                </button>
                <br>
                <button (click)="openUrlDialog($event)"
                title="Generate Möbius view url from url of .mob file">
                    <mat-icon>link</mat-icon>
                    &nbsp;Publish&nbsp;
                </button>
            </div>
        </div>
    </div>
</div>
<dialog id='genUrlDialog'>
    <p>To publish your model, please upload your Möbius (.mob) file to an online file server to allows
        you to share the URL. (For example, you can upload your file to platforms such Github, Dropbox
        and Qiniu.) Then paste the URL for file below, and click 'Validate Url'. </p>
    <br>
    <br>
    MOB file URL: <br>
    <textarea [(ngModel)]='urlSet[0]' 
            [class.valid]='urlValid === true' 
            [class.invalid]='urlValid === false'
            (keyup)='urlValid = undefined'></textarea><br>
    <button (click)='validateUrl()'>Validate Url</button>

    <ng-container *ngIf='urlValid === true'>
    
        <hr>
        <input id='radio1' type='radio' name='showPage' value='publish' [(ngModel)]='urlSet[1]'/> <label for='radio1'>Uneditable</label> <br>
        <input id='radio2' type='radio' name='showPage' value='dashboard' [(ngModel)]='urlSet[1]'/> <label for='radio2'>Editable</label>
        <hr>
    
        <ng-container *ngIf='urlSet[1] == "dashboard"; else publish_template'>
            <input id='radio3' type='radio' name='displayType' value='&node=' [(ngModel)]='urlSet[2]'/> <label for='radio3'>Show Specific Node</label> <br>
            <input id='radio4' type='radio' name='displayType' value='' [(ngModel)]='urlSet[2]'/> <label for='radio4'>Show Dashboard</label> 
            <hr>
            <ng-container *ngIf='urlSet[2] == "&node="'>
                <!-- Shown Node Index: <input [(ngModel)]='urlSet[3]'/> -->
                Shown Node: <select [(ngModel)]='urlSet[3]'>
                    <option *ngFor='let node of urlNodes; let i = index' value={{i}}>{{i}}. {{node.name}}</option>
                </select>
                <hr>
            </ng-container>
        </ng-container>
        <ng-template #publish_template>
            <input id='radio3D' type='radio' name='showViewer' value='&viewer=0' [(ngModel)]='urlSet[4]'/> <label for='radio3D'>3D Viewer</label> <br>
            <input id='radioGeo' type='radio' name='showViewer' value='&viewer=1' [(ngModel)]='urlSet[4]'/> <label for='radioGeo'>Geo Viewer</label> <br>
            <input id='radioBothV' type='radio' name='showViewer' value='' [(ngModel)]='urlSet[4]'/> <label for='radioBothV'>Both</label>
            <hr>
        </ng-template>
    
        <button (click)='generateUrl()'>Create Link</button>

        <div>
            <hr>
            Möbius Link:<br>
            <textarea [class.disabled]='true' id='generatedLink' disabled></textarea>
        </div>
    </ng-container>

</dialog>
